{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "util-foundry.json",
	"title": "Util: Foundry",
	"version": "1.0.9",
	"$defs": {
		"entryDataObject": {
			"description": "Additional \"5etools-type\" data to be stored on the entry.",
			"type": "object",
			"properties": {
				"languageProficiencies": {
					"$ref": "util.json#/$defs/languageProficiencies"
				},
				"skillProficiencies": {
					"$ref": "util.json#/$defs/skillProficiencies"
				},
				"weaponProficiencies": {
					"$ref": "util.json#/$defs/weaponProficiencies"
				},
				"armorProficiencies": {
					"$ref": "util.json#/$defs/armorProficiencies"
				},
				"toolProficiencies": {
					"$ref": "util.json#/$defs/toolProficiencies"
				},
				"savingThrowProficiencies": {
					"$ref": "util.json#/$defs/savingThrowProficiencies"
				},
				"skillToolLanguageProficiencies": {
					"$ref": "util.json#/$defs/skillToolLanguageProficiencies"
				},
				"expertise": {
					"$ref": "util.json#/$defs/expertise"
				},
				"resist": {
					"$ref": "util.json#/$defs/damageResistArrayPlayer"
				},
				"immune": {
					"$ref": "util.json#/$defs/damageImmunityArrayPlayer"
				},
				"vulnerable": {
					"$ref": "util.json#/$defs/damageVulnerabilityArrayPlayer"
				},
				"conditionImmune": {
					"$ref": "util.json#/$defs/conditionImmunityArrayPlayer"
				},
				"resources": {
					"$ref": "util.json#/$defs/resourcesArray"
				},
				"senses": {
					"$ref": "util.json#/$defs/sensesArray"
				},
				"additionalSpells": {
					"$ref": "util-additionalspells.json#/$defs/additionalSpellsArray"
				}
			},
			"additionalProperties": false
		},
		"foundryId": {
			"type": "string",
			"minLength": 16,
			"maxLength": 16,
			"pattern": "^[A-Za-z0-9]+$"
		},
		"foundryIdShort": {
			"type": "string",
			"minLength": 1,
			"maxLength": 16,
			"pattern": "^[A-Za-z0-9]+$"
		},
		"foundryTokenScale": {
			"type": "number",
			"minimum": 0.2,
			"maximum": 3,
			"multipleOf": 0.1
		},
		"foundryTokenSubjectScale": {
			"type": "number",
			"minimum": 0.8,
			"maximum": 3,
			"multipleOf": 0.1
		},
		"foundrySystemObject": {
			"type": "object"
		},
		"foundryFlagsObject": {
			"type": "object"
		},
		"foundryAdvancementObject": {
			"type": "object"
		},
		"foundryAdvancementsArray": {
			"type": "array",
			"minItems": 1,
			"items": {
				"$ref": "#/$defs/foundryAdvancementObject"
			},
			"uniqueItems": true
		},
		"foundryPrototypeTokenObject": {
			"type": "object"
		},
		"foundryImg": {
			"type": "string"
		},
		"foundrySubEntitiesObject": {
			"description": "A 5etools-data-like object of additional entities to import.",
			"type": "object",
			"properties": {
				"item": {
					"$ref": "items.json#/$defs/subEntityItemArray"
				}
			},
			"minProperties": 1
		},
		"_foundryActivityObject_base": {
			"type": "object",
			"properties": {
				"consumption": {
					"type": "object",
					"properties": {
						"targets": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"target": {
										"oneOf": [
											{
												"type": "string"
											},
											{
												"type": "object",
												"properties": {
													"prop": {
														"type": "string"
													},
													"uid": {
														"type": "string"
													}
												},
												"required": [
													"prop",
													"uid"
												],
												"additionalProperties": false
											}
										]
									}
								}
							}
						}
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"foundryId": {
								"$ref": "#/$defs/foundryIdShort"
							}
						},
						"required": [
							"foundryId"
						]
					}
				}
			},
			"required": [
				"type"
			]
		},
		"_foundryActivityObject_damage": {
			"type": "object",
			"properties": {
				"consumption": {
					"type": "object",
					"properties": {
						"targets": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"target": {
										"oneOf": [
											{
												"type": "string"
											},
											{
												"type": "object",
												"properties": {
													"prop": {
														"type": "string"
													},
													"uid": {
														"type": "string"
													}
												},
												"required": [
													"prop",
													"uid"
												],
												"additionalProperties": false
											}
										]
									}
								}
							}
						}
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"foundryId": {
								"$ref": "#/$defs/foundryIdShort"
							}
						},
						"required": [
							"foundryId"
						]
					}
				},
				"type": {
					"const": "damage"
				}
			},
			"required": [
				"type"
			]
		},
		"_foundryActivityObject_save": {
			"type": "object",
			"properties": {
				"consumption": {
					"type": "object",
					"properties": {
						"targets": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"target": {
										"oneOf": [
											{
												"type": "string"
											},
											{
												"type": "object",
												"properties": {
													"prop": {
														"type": "string"
													},
													"uid": {
														"type": "string"
													}
												},
												"required": [
													"prop",
													"uid"
												],
												"additionalProperties": false
											}
										]
									}
								}
							}
						}
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"foundryId": {
								"$ref": "#/$defs/foundryIdShort"
							}
						},
						"required": [
							"foundryId"
						]
					}
				},
				"type": {
					"const": "save"
				}
			},
			"required": [
				"type"
			]
		},
		"_foundryActivityObject_heal": {
			"type": "object",
			"properties": {
				"consumption": {
					"type": "object",
					"properties": {
						"targets": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"target": {
										"oneOf": [
											{
												"type": "string"
											},
											{
												"type": "object",
												"properties": {
													"prop": {
														"type": "string"
													},
													"uid": {
														"type": "string"
													}
												},
												"required": [
													"prop",
													"uid"
												],
												"additionalProperties": false
											}
										]
									}
								}
							}
						}
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"foundryId": {
								"$ref": "#/$defs/foundryIdShort"
							}
						},
						"required": [
							"foundryId"
						]
					}
				},
				"type": {
					"const": "heal"
				}
			},
			"required": [
				"type"
			]
		},
		"_foundryActivityObject_utility": {
			"type": "object",
			"properties": {
				"consumption": {
					"type": "object",
					"properties": {
						"targets": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"target": {
										"oneOf": [
											{
												"type": "string"
											},
											{
												"type": "object",
												"properties": {
													"prop": {
														"type": "string"
													},
													"uid": {
														"type": "string"
													}
												},
												"required": [
													"prop",
													"uid"
												],
												"additionalProperties": false
											}
										]
									}
								}
							}
						}
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"foundryId": {
								"$ref": "#/$defs/foundryIdShort"
							}
						},
						"required": [
							"foundryId"
						]
					}
				},
				"type": {
					"const": "utility"
				}
			},
			"required": [
				"type"
			]
		},
		"foundryActivityObject": {
			"anyOf": [
				{
					"$ref": "#/$defs/_foundryActivityObject_damage"
				},
				{
					"$ref": "#/$defs/_foundryActivityObject_save"
				},
				{
					"$ref": "#/$defs/_foundryActivityObject_heal"
				},
				{
					"$ref": "#/$defs/_foundryActivityObject_utility"
				}
			]
		},
		"_foundryEffectObject": {
			"type": "object",
			"properties": {
				"foundryId": {
					"description": "Use only when required. For example, when linking an \"enchantmentRiderParent\".",
					"$ref": "#/$defs/foundryIdShort"
				},
				"name": {
					"type": "string"
				},
				"img": {
					"type": "string"
				},
				"description": {
					"type": "string"
				},
				"changes": {
					"type": "array",
					"items": {
						"type": "object",
						"properties": {
							"key": {
								"type": "string"
							},
							"mode": {
								"type": [
									"string",
									"integer"
								]
							},
							"value": true,
							"priority": {
								"type": [
									"string",
									"integer"
								]
							}
						},
						"required": [
							"key",
							"mode",
							"value"
						],
						"additionalProperties": false
					}
				},
				"statuses": {
					"description": "Dumped via e.g. `copy(Object.keys(CONFIG.DND5E.conditionTypes).sort())`",
					"type": "array",
					"items": {
						"type": "string",
						"enum": [
							"bleeding",
							"blinded",
							"charmed",
							"cursed",
							"deafened",
							"diseased",
							"exhaustion",
							"frightened",
							"grappled",
							"incapacitated",
							"invisible",
							"paralyzed",
							"petrified",
							"poisoned",
							"prone",
							"restrained",
							"silenced",
							"stunned",
							"surprised",
							"transformed",
							"unconscious"
						]
					}
				},
				"flags": {
					"type": "object"
				},
				"duration": {
					"type": "object"
				},
				"disabled": {
					"const": true
				},
				"transfer": {
					"const": true
				},
				"enchantmentLevelMin": {
					"type": "number",
					"minimum": 0,
					"maximum": 20
				},
				"enchantmentLevelMax": {
					"type": "number",
					"minimum": 0,
					"maximum": 20
				},
				"enchantmentRiderParent": {
					"$ref": "#/$defs/foundryIdShort"
				},
				"type": {
					"type": "string",
					"enum": [
						"enchantment"
					]
				}
			},
			"additionalProperties": false
		},
		"foundryEffectObject": {
			"anyOf": [
				{
					"allOf": [
						{
							"$ref": "#/$defs/_foundryEffectObject"
						},
						{
							"type": "object",
							"required": [
								"changes"
							]
						}
					]
				},
				{
					"allOf": [
						{
							"$ref": "#/$defs/_foundryEffectObject"
						},
						{
							"type": "object",
							"required": [
								"statuses"
							]
						}
					]
				},
				{
					"description": "An effect with no functional changes, but descriptive text. Should only be used for effects which cannot be otherwise automated.",
					"allOf": [
						{
							"$ref": "#/$defs/_foundryEffectObject"
						},
						{
							"type": "object",
							"required": [
								"description"
							]
						}
					]
				}
			]
		},
		"foundryEffectsArray": {
			"type": "array",
			"items": {
				"$ref": "#/$defs/foundryEffectObject"
			},
			"minItems": 1,
			"uniqueItems": true
		},
		"foundrySideDataGenericObject": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string"
				},
				"source": {
					"$ref": "util.json#/$defs/source"
				},
				"system": {
					"$ref": "#/$defs/foundrySystemObject"
				},
				"activities": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryActivityObject"
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryEffectObject"
					}
				},
				"flags": {
					"$ref": "#/$defs/foundryFlagsObject"
				},
				"img": {
					"type": "string"
				},
				"migrationVersion": {
					"type": "integer"
				},
				"_merge": {
					"type": "object",
					"description": "If our \"X\" (e.g. \"system\") should be merged with any base \"X\", rather than overwriting.",
					"properties": {
						"system": {
							"const": true
						},
						"chooseSystem": {
							"const": true
						},
						"activities": {
							"const": true
						},
						"effects": {
							"const": true
						},
						"flags": {
							"const": true
						},
						"chooseFlags": {
							"const": true
						}
					}
				}
			},
			"required": [
				"name",
				"source"
			],
			"additionalProperties": false
		},
		"foundrySideDataGenericArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"$ref": "#/$defs/foundrySideDataGenericObject"
			}
		},
		"foundrySideDataGenericFeatureObject": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string"
				},
				"source": {
					"$ref": "util.json#/$defs/source"
				},
				"system": {
					"$ref": "#/$defs/foundrySystemObject"
				},
				"activities": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryActivityObject"
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryEffectObject"
					}
				},
				"flags": {
					"$ref": "#/$defs/foundryFlagsObject"
				},
				"img": {
					"type": "string"
				},
				"migrationVersion": {
					"type": "integer"
				},
				"_merge": {
					"type": "object",
					"description": "If our \"X\" (e.g. \"system\") should be merged with any base \"X\", rather than overwriting.",
					"properties": {
						"system": {
							"const": true
						},
						"chooseSystem": {
							"const": true
						},
						"activities": {
							"const": true
						},
						"effects": {
							"const": true
						},
						"flags": {
							"const": true
						},
						"chooseFlags": {
							"const": true
						}
					}
				},
				"entries": {
					"type": "array",
					"items": {
						"$ref": "entry.json"
					}
				},
				"isIgnored": {
					"const": true
				},
				"ignoreSrdActivities": {
					"const": true
				},
				"ignoreSrdEffects": {
					"const": true
				},
				"actorDataMod": {
					"type": "object"
				},
				"subEntities": {
					"$ref": "#/$defs/foundrySubEntitiesObject"
				}
			},
			"required": [
				"name",
				"source"
			],
			"additionalProperties": false
		},
		"foundrySideDataGenericFeatureArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"$ref": "#/$defs/foundrySideDataGenericFeatureObject"
			}
		},
		"foundrySideDataGenericActorObject": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string"
				},
				"source": {
					"$ref": "util.json#/$defs/source"
				},
				"system": {
					"$ref": "#/$defs/foundrySystemObject"
				},
				"activities": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryActivityObject"
					}
				},
				"effects": {
					"type": "array",
					"items": {
						"$ref": "#/$defs/foundryEffectObject"
					}
				},
				"flags": {
					"$ref": "#/$defs/foundryFlagsObject"
				},
				"img": {
					"type": "string"
				},
				"migrationVersion": {
					"type": "integer"
				},
				"_merge": {
					"type": "object",
					"description": "If our \"X\" (e.g. \"system\") should be merged with any base \"X\", rather than overwriting.",
					"properties": {
						"system": {
							"const": true
						},
						"chooseSystem": {
							"const": true
						},
						"activities": {
							"const": true
						},
						"effects": {
							"const": true
						},
						"flags": {
							"const": true
						},
						"chooseFlags": {
							"const": true
						}
					}
				},
				"prototypeToken": {
					"$ref": "#/$defs/foundryPrototypeTokenObject"
				}
			},
			"required": [
				"name",
				"source"
			],
			"additionalProperties": false
		},
		"foundrySideDataGenericActorArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"$ref": "#/$defs/foundrySideDataGenericActorObject"
			}
		}
	}
}